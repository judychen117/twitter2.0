(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e19cf3d"],{"439d":function(t,e,s){},"4b79":function(t,e,s){t.exports=s.p+"img/UserAvatar.3a1de5c2.svg"},a6cc:function(t,e,s){},b476:function(t,e,s){"use strict";s("a6cc")},b6c0:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-tweets",attrs:{id:"main"}},[s("NavBar",{on:{"show-post-modal":t.showModalBox}}),"none"!==t.showModal?s("div",{attrs:{id:"fade"}}):t._e(),s("UserPostmodal",{directives:[{name:"show",rawName:"v-show",value:"post"===t.showModal,expression:"showModal === 'post'"}],on:{"close-post-modal":t.closePostModal}}),s("UserReplymodal",{directives:[{name:"show",rawName:"v-show",value:"reply"===t.showModal,expression:"showModal === 'reply'"}],attrs:{"initial-modal-tweet":t.replyModalTweet},on:{"close-post-modal":t.closePostModal}}),s("div",{staticClass:"tweets-container"},[t._m(0),s("div",{staticClass:"tweets"},[s("div",{staticClass:"tweets-post-card"},[s("div",{staticClass:"tweets-post"},[s("router-link",{attrs:{to:{name:"user-profile-tweet",params:{id:t.currentUser.id}}}},[s("img",{staticClass:"tweets-avatar",attrs:{src:t.currentUser.avatar,alt:"avatar"}})]),s("form",{staticClass:"tweets-form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[s("div",{staticClass:"tweets-text"},[s("label",{attrs:{for:"text"}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control",attrs:{rows:"3",name:"text",placeholder:"有什麼新鮮事？"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})]),t._m(1)])],1)]),s("div",{staticClass:"divider"}),s("div",{staticClass:"tweets-list"},t._l(t.tweets,(function(e){return s("TweetCard",{key:e.id,attrs:{"initial-tweet":e},on:{"show-reply-modal":t.showModalBox,"reply-tweet-id":t.showReplyModal}})})),1)])]),s("RecommendUsers")],1)},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweets-header"},[s("a",{attrs:{href:""}},[t._v("首頁")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweets-submit"},[s("button",{staticClass:"tweets-button",attrs:{type:"submit"}},[t._v("推文")])])}],n=s("1da1"),i=s("5530"),o=(s("5319"),s("ac1f"),s("96cf"),s("88fd")),c=s("d178"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tweets-card"},[a("router-link",{attrs:{to:{name:"user-profile-tweet",params:{id:t.tweet.User.id}}}},[a("img",{staticClass:"tweets-avatar",attrs:{src:t._f("emptyPicture")(t.tweet.User.avatar),alt:"avatar"}})]),a("div",{staticClass:"tweets-content"},[a("a",{staticClass:"tweet tweets-title",attrs:{href:""}},[a("router-link",{attrs:{to:{name:"user-profile-tweet",params:{id:t.tweet.User.id}}}},[a("div",{staticClass:"tweets-name"},[t._v(t._s(t.tweet.User.name))])]),a("router-link",{attrs:{to:{name:"user-profile-tweet",params:{id:t.tweet.User.id}}}},[a("div",{staticClass:"tweets-id"},[t._v(t._s(t.tweet.User.account)+"・")])]),a("div",{staticClass:"tweets-time"},[t._v(t._s(t._f("fromNow")(t.tweet.createdAt)))])],1),a("router-link",{attrs:{to:{name:"tweet-reply",params:{tweet_id:t.tweet.id}}}},[a("div",{staticClass:"tweet tweets-text"},[a("p",{staticClass:"card-text"},[t._v(" "+t._s(t.tweet.description)+" ")])])]),a("div",{staticClass:"tweet tweets-footer"},[a("a",{staticClass:"tweets-comment",attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.replyPost(t.tweet)}}},[a("img",{staticClass:"icon",attrs:{src:s("6edd"),alt:""}}),a("span",[t._v(t._s(t.tweet.Replies.length))])]),t.likeStatus?a("a",{staticClass:"tweets-like",attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteLiked(t.tweet.id)}}},[a("img",{staticClass:"icon",attrs:{src:s("b768"),alt:""}}),a("span",{staticStyle:{color:"#e0245e"}},[t._v(t._s(t.tweet.Likes.length))])]):a("a",{staticClass:"tweets-like",attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addLiked(t.tweet.id)}}},[a("img",{staticClass:"icon",attrs:{src:s("9291"),alt:""}}),a("span",[t._v(t._s(t.likesLength))])])])],1)],1)},u=[],d=(s("159b"),s("2708")),w=s("1602"),p=s("2fa3"),f=s("2f62"),m={components:{},mixins:[d["c"],d["a"]],props:{initialTweet:{type:Object,required:!0}},data:function(){return{tweet:this.initialTweet,showModal:"",likeStatus:!1,likesLength:this.initialTweet.Likes.length}},created:function(){this.checkLikeId(this.tweet)},updated:function(){},computed:Object(i["a"])({},Object(f["b"])(["currentUser"])),methods:{addLiked:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var a,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,w["a"].addLiked(t);case 3:if(a=s.sent,r=a.data,"success"===r.status){s.next=7;break}throw new Error(r.message);case 7:e.likesLength=e.likesLength+1,e.likeStatus=!0,s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](0),p["a"].fire({icon:"error",title:"暫時無法加入喜歡,請稍後再試"});case 14:case"end":return s.stop()}}),s,null,[[0,11]])})))()},deleteLiked:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var a,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,w["a"].deleteLiked(t);case 3:if(a=s.sent,r=a.data,"success"===r.status){s.next=7;break}throw new Error(r.message);case 7:e.likesLength=e.likesLength-1,e.likeStatus=!1,s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](0),p["a"].fire({icon:"error",title:"暫時無法移除喜歡,請稍後再試"});case 14:case"end":return s.stop()}}),s,null,[[0,11]])})))()},replyPost:function(t){this.showModal="reply",this.$emit("show-reply-modal",this.showModal),this.$emit("reply-tweet-id",t)},closePostModal:function(t){this.showModal=t},checkLikeId:function(t){var e=this;t.Likes.forEach((function(t){t.UserId!==e.currentUser.id||(e.likeStatus=!0)}))}}},h=m,v=(s("b476"),s("2877")),x=Object(v["a"])(h,l,u,!1,null,"316bcacd",null),b=x.exports,k=s("6783"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal-box"},[s("div",{staticClass:"tweets-header",staticStyle:{cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeModal(e)}}},[t._v(" X ")]),s("div",{staticClass:"tweets-post-card"},[s("div",{staticClass:"tweets-post"},[t._m(0),s("form",{staticClass:"tweets-form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[s("div",{staticClass:"tweets-text"},[s("label",{attrs:{for:"text"}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control",attrs:{rows:"3",name:"text",placeholder:"有什麼新鮮事？"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})]),t._m(1)])])])])},C=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{attrs:{href:""}},[a("img",{staticClass:"tweets-avatar",attrs:{src:s("4b79"),alt:"avatar"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweets-submit"},[s("button",{staticClass:"tweets-button",attrs:{type:"submit"}},[t._v("推文")])])}],_={data:function(){return{text:"",showModal:"none"}},methods:{handleSubmit:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,""!==t.text.replace(/\s*/g,"")){e.next=4;break}return p["a"].fire({icon:"error",title:"推文內容不能空白,請輸入內容"}),e.abrupt("return");case 4:if(!(t.text.length>=140)){e.next=7;break}return p["a"].fire({icon:"error",title:"超過字數限制,最多不可超過140字,請重新輸入"}),e.abrupt("return");case 7:return s=t.text,e.next=10,k["a"].tweets.post({description:s});case 10:if(a=e.sent,r=a.data,"success"===r.status){e.next=14;break}throw new Error(r.message);case 14:t.text="",t.$emit("close-post-modal",t.showModal),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](0),p["a"].fire({icon:"error",title:"暫時無法新增推文,請稍後再試"});case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()},closeModal:function(){this.$emit("close-post-modal",this.showModal)}}},M=_,y=(s("cce7"),Object(v["a"])(M,g,C,!1,null,"b24bb1b8",null)),U=y.exports,L=s("9309"),P=s("4360"),R={components:{RecommendUsers:o["a"],NavBar:c["a"],TweetCard:b,UserPostmodal:U,UserReplymodal:L["a"]},data:function(){return{tweets:[],text:"",showModal:"none",replyModalTweet:{}}},created:function(){console.log(P["a"].state),this.fetchTweets()},computed:Object(i["a"])({},Object(f["b"])(["currentUser"])),methods:{fetchTweets:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k["a"].tweets.get();case 3:s=e.sent,a=s.data,t.tweets=a,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),p["a"].fire({icon:"error",title:"暫時無法獲取推文,請稍後再試"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},handleSubmit:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,""!==t.text.replace(/\s*/g,"")){e.next=4;break}return p["a"].fire({icon:"error",title:"推文內容不能空白,請輸入內容"}),e.abrupt("return");case 4:if(!(t.text.length>=140)){e.next=7;break}return p["a"].fire({icon:"error",title:"超過字數限制,最多不可超過140字,請重新輸入"}),e.abrupt("return");case 7:return s=t.text,e.next=10,k["a"].tweets.post({description:s});case 10:if(a=e.sent,r=a.data,"success"===r.status){e.next=14;break}throw new Error(r.message);case 14:t.text="",t.fetchTweets(),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](0),p["a"].fire({icon:"error",title:"新增推文錯誤,請稍後再試"});case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()},showModalBox:function(t){this.showModal=t},closePostModal:function(t){this.showModal=t,this.fetchTweets()},showReplyModal:function(t){this.replyModalTweet=t}}},j=R,O=(s("c984"),Object(v["a"])(j,a,r,!1,null,"6f187189",null));e["default"]=O.exports},c3e1:function(t,e,s){},c984:function(t,e,s){"use strict";s("c3e1")},cce7:function(t,e,s){"use strict";s("439d")}}]);
//# sourceMappingURL=chunk-1e19cf3d.73e28a8a.js.map